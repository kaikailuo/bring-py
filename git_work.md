# ğŸ§­ Git å›¢é˜Ÿåä½œå¼€å‘æµç¨‹æŒ‡å—

## ğŸŒ± ä¸€ã€åˆ†æ”¯æ¨¡å‹è¯´æ˜

    mainï¼ˆç¨³å®šå¯å‘å¸ƒï¼‰
    â†‘
    â”‚
    â”‚ ğŸ” Pull Request åˆå¹¶ï¼ˆæµ‹è¯•é€šè¿‡ï¼‰
    â”‚
    devï¼ˆé›†æˆå¼€å‘åˆ†æ”¯ï¼‰
    â†‘
    â”‚
    â”‚ ğŸ”€ æœ¬åœ°åˆå¹¶åŠŸèƒ½åˆ†æ”¯
    â”‚
    feature/åŠŸèƒ½-å¼€å‘è€…ï¼ˆä¸ªäººå¼€å‘åˆ†æ”¯ï¼‰

### åˆ†æ”¯å‘½åè§„èŒƒ

| ç±»å‹ | å‘½åæ ¼å¼ | ç¤ºä¾‹ |
|------|-----------|------|
| åŠŸèƒ½åˆ†æ”¯ | `feature/<åŠŸèƒ½>-<å¼€å‘è€…>` | `feature/login-kaikai` |
| ä¿®å¤åˆ†æ”¯ | `fix/<é—®é¢˜>-<å¼€å‘è€…>` | `fix/token-expire-lu` |
| å®éªŒåˆ†æ”¯ | `exp/<å°è¯•>-<å¼€å‘è€…>` | `exp/ui-redesign-kaikai` |

---

## ğŸ§© äºŒã€å®Œæ•´åä½œæµç¨‹

### 1ï¸âƒ£ æ›´æ–°æœ¬åœ° main ä¸ dev
åœ¨å¼€å§‹æ–°åŠŸèƒ½å‰ï¼ŒåŠ¡å¿…å…ˆåŒæ­¥è¿œç¨‹æœ€æ–°ä»£ç ï¼š
```bash
git checkout main
git pull origin main

git checkout dev
git pull origin dev
```
### 2ï¸âƒ£ ä» dev åˆ›å»º feature åˆ†æ”¯
```bash

git checkout dev
git pull origin dev
git checkout -b feature/<åŠŸèƒ½>-<å¼€å‘è€…>

âœ… æ‰€æœ‰åŠŸèƒ½åˆ†æ”¯éƒ½åŸºäº dev åˆ›å»ºï¼Œè€Œä¸æ˜¯ mainã€‚(git branch å¯æŸ¥çœ‹å½“å‰åˆ†æ”¯)
```
### 3ï¸âƒ£ å¼€å‘ä¸æäº¤ä»£ç 
```bash
git add .
git commit -m "æäº¤ä¿¡æ¯"
Commit ä¿¡æ¯è§„èŒƒï¼š

ç±»å‹    	    å‰ç¼€	         ç¤ºä¾‹
æ–°åŠŸèƒ½	    feat:	     feat: æ–°å¢æ³¨å†ŒåŠŸèƒ½
ä¿®å¤		    fix:         fix: ä¿®å¤ token è¿‡æœŸé—®é¢˜
ä¼˜åŒ–/é‡æ„	refactor:    refactor: ä¼˜åŒ–æ•°æ®åº“è¿æ¥
æ–‡æ¡£    	    docs:	     docs: æ›´æ–°æ¥å£è¯´æ˜æ–‡æ¡£
```
### 4ï¸âƒ£ ä¸Šä¼  feature åˆ†æ”¯åˆ°è¿œç¨‹
```bash
git push origin feature/<åŠŸèƒ½>-<å¼€å‘è€…>
ğŸ“Œ ä¸Šä¼ è¿œç¨‹æ˜¯ä¸ºäº†å¤‡ä»½ä¸è®©å›¢é˜Ÿå¯è§ã€‚
ä¸è¦ç›´æ¥ push åˆ° main æˆ– devï¼
```
### 5ï¸âƒ£ åˆå¹¶åˆ° devï¼ˆæœ¬åœ°æµ‹è¯•åï¼‰
```bash
git checkout dev
git pull origin dev
git merge feature/<åŠŸèƒ½>-<å¼€å‘è€…>
è‹¥æœ‰å†²çªï¼š


# æ‰‹åŠ¨è§£å†³å
git add .
git commit
ç„¶åæ¨é€ï¼š


git push origin dev
```
### 6ï¸âƒ£ æäº¤ Pull Request ç»™ main
```base
åœ¨ GitHub ä¸Šï¼š

base: main

compare: dev

æ ‡é¢˜ç¤ºä¾‹ï¼šfeat: ç™»å½•åŠŸèƒ½æµ‹è¯•å®Œæˆï¼ˆby Kaikaiï¼‰

ç”±å›¢é˜Ÿè´Ÿè´£äººå®¡æ ¸ã€æµ‹è¯•ååˆå¹¶ã€‚
```
### 7ï¸âƒ£ æ¸…ç†æ— ç”¨åˆ†æ”¯
å¼€å‘å®Œæˆåå¯æ¸…ç†ï¼š
```bash

git branch -d feature/<åŠŸèƒ½>-<å¼€å‘è€…>             # åˆ é™¤æœ¬åœ°
git push origin --delete feature/<åŠŸèƒ½>-<å¼€å‘è€…>   # åˆ é™¤è¿œç¨‹
```
## ğŸ§  ä¸‰ã€å›¢é˜Ÿæ“ä½œå»ºè®®
| æ“ä½œ           | å»ºè®®                         |
| ------------ | -------------------------- |
| æ¯æ¬¡å¼€å‘å‰        | `git pull origin dev` ä¿æŒæœ€æ–° |
| åŠŸèƒ½åˆ†æ”¯å®Œæˆ       | åˆå¹¶åˆ° dev ååˆ é™¤åˆ†æ”¯              |
| Pull Request | è‡³å°‘ä¸€äººå®¡æ ¸åå†åˆå¹¶                 |
| æäº¤å‰          | è¿è¡Œæµ‹è¯•ã€lintã€æ ¼å¼åŒ–ä»£ç             |
| main åˆ†æ”¯      | æ‰“å¼€ GitHub ä¿æŠ¤ï¼Œä¸å…è®¸ç›´æ¥ push    |

## ğŸ§° å››ã€å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥è¡¨
| ç›®æ ‡       | å‘½ä»¤                                  |
| -------- | ----------------------------------- |
| å…‹éš†ä»“åº“     | `git clone <repo-url>`              |
| æŸ¥çœ‹åˆ†æ”¯     | `git branch -a`                     |
| åˆ‡æ¢åˆ†æ”¯     | `git checkout <branch>`             |
| æ–°å»ºåˆ†æ”¯     | `git checkout -b <branch>`          |
| åˆ é™¤åˆ†æ”¯     | `git branch -d <branch>`            |
| åˆ é™¤è¿œç¨‹åˆ†æ”¯   | `git push origin --delete <branch>` |
| æŸ¥çœ‹åˆå¹¶æƒ…å†µ   | `git branch --merged`               |
| æ’¤é”€æœ€è¿‘ä¸€æ¬¡æäº¤ | `git reset --soft HEAD~1`           |


## ğŸ§­ äº”ã€æ•´ä½“æµç¨‹å›¾
        +-------------------+
        |     mainï¼ˆç¨³å®šï¼‰  |
        +-------------------+

                  â†‘
                  â”‚ Pull Requestï¼ˆæµ‹è¯•é€šè¿‡ï¼‰
                  â”‚
        +-------------------+
        |      devï¼ˆé›†æˆï¼‰  |
        +-------------------+
                  â†‘
                  â”‚ æœ¬åœ°åˆå¹¶ & æµ‹è¯•
                  â”‚
        +-----------------------------+
        | feature/login-kaikaiï¼ˆåŠŸèƒ½å¼€å‘ï¼‰ |
        +-----------------------------+
## âœ¨ å…­ã€æ€»ç»“ä¸€å¥è¯
ğŸ—£ï¸ ã€Œæ¯ä¸ªåŠŸèƒ½ç‹¬ç«‹åˆ†æ”¯ â†’ åˆå¹¶åˆ° dev æµ‹è¯• â†’ é€šè¿‡å PR ç»™ mainã€

ğŸš« ä¸ç›´æ¥ push mainï¼ŒğŸš€ ä¿æŒ main ç¨³å®šå¹²å‡€ï¼
ä¸€å¥è¯æ„¿æ™¯ï¼ˆMVPï¼‰

å­¦ç”Ÿèƒ½åœ¨æµè§ˆå™¨é‡Œå†™ä»£ç ï¼ˆå¤šè¯­è¨€å¯é€‰ï¼‰ï¼Œç‚¹å‡»è¿è¡Œå¾—åˆ°è¾“å‡ºï¼›åœ¨ç»ƒä¹ é¡µé¢èƒ½å‘å†…ç½®â€œæ™ºèƒ½åŠ©æ•™â€æé—®ï¼ˆæŠŠä»£ç  + è¿è¡Œç»“æœ + ä½œç­”æ„å›¾å‘ç»™ LLMï¼‰ï¼Œå¾—åˆ°é’ˆå¯¹æ€§çš„æç¤ºã€é”™è¯¯è§£é‡Šã€æ”¹è¿›å»ºè®®æˆ–ç¤ºä¾‹è§£æ³•ã€‚æ•™å¸ˆèƒ½å‘å¸ƒç»ƒä¹ ã€æŸ¥çœ‹æäº¤ã€è‡ªåŠ¨/æ‰‹åŠ¨è¯„åˆ†ã€çœ‹åˆ°å­¦ç”Ÿè¿›åº¦ã€‚

é«˜å±‚æ¶æ„ï¼ˆæ¨¡å—ä¸æ•°æ®æµï¼‰

å‰ç«¯ï¼ˆReactï¼‰

ç¼–è¾‘å™¨ï¼ˆMonaco / CodeMirrorï¼‰

è¿è¡Œ/æäº¤æŒ‰é’®ã€è¾“å‡ºé¢æ¿ã€å†å²è®°å½•ã€LLM èŠå¤©ä¾§æ 

åç«¯ APIï¼ˆFastAPI / Nodeï¼‰

è®¤è¯ã€è¯¾ç¨‹/é¢˜åº“ç®¡ç†ã€æäº¤ç®¡ç†ã€è°ƒç”¨æ‰§è¡Œå™¨ APIã€LLM ä¸­è½¬æœåŠ¡ã€æˆç»©å­˜å‚¨

ä»£ç æ‰§è¡Œæ²™ç®±ï¼ˆJudgeï¼‰

éš”ç¦»æ‰§è¡Œï¼ˆDocker / Firecracker / gVisor / ç‹¬ç«‹å®¹å™¨æ± ï¼‰ + é™æ—¶/é™å†…å­˜/é™åˆ¶ syscalls

æ¥å£ï¼šæäº¤ä»£ç  + stdin + è¯­è¨€ â†’ è¿”å› stdout/stderr/exitcode/èµ„æºä½¿ç”¨

å»ºè®®å¯ç”¨å¼€æºæœåŠ¡ï¼šJudge0 / Pistonï¼Œæˆ–è‡ªå·±ç”¨ Docker + timeoutï¼ˆè§ç¤ºä¾‹ï¼‰

LLM æœåŠ¡ï¼ˆOpenAI æˆ–ç§æœ‰æ¨¡å‹ï¼‰

åç«¯å°è£… prompt æ¨¡æ¿ã€ä¸Šä¸‹æ–‡å»ºæ„ã€è°ƒç”¨å¹¶è¿”å›å»ºè®®

æ•°æ®åº“ï¼ˆPostgresï¼‰ & å­˜å‚¨ï¼ˆS3ï¼‰

ä¿å­˜ç”¨æˆ·ã€è¯¾ç¨‹ã€ç»ƒä¹ ã€æäº¤ã€æ¨¡å‹äº¤äº’è®°å½•ï¼ˆç”¨äºå¤ç›˜/æ”¹è¿› promptï¼‰

ç®¡ç†/æ•™å¸ˆç•Œé¢ & æŠ¥è¡¨

CI/CD + ç›‘æ§ï¼ˆPrometheus / Sentryï¼‰

æŠ€æœ¯é€‰å‹å»ºè®®ï¼ˆMVP å‹å¥½ï¼‰

å‰ç«¯ï¼šReact + Vite + Monaco Editorï¼ˆä»£ç ä½“éªŒå¥½ï¼‰

åç«¯ï¼šPython FastAPIï¼ˆå¿«é€Ÿå¼€å‘ & asyncï¼‰

ä»£ç æ‰§è¡Œï¼šå…ˆç”¨ Judge0 æˆ– Pistonï¼ˆè½»é‡ã€ç°æˆï¼‰ã€‚è‹¥è‡ªå»ºï¼šDocker æ± ï¼ˆé rootã€seccompã€cgroupsã€é™å®š CPU/å†…å­˜/æ—¶é—´ï¼‰

LLMï¼šOpenAI APIï¼ˆChat Completions / Responsesï¼‰æˆ–ä¼ä¸šæ¨¡å‹ï¼›åç«¯åšä¸€å±‚å°è£…ä¸å®¡è®¡

DBï¼šPostgresï¼›æ–‡ä»¶å¯ä¸Š S3ï¼ˆç»ƒä¹ èµ„æºã€æµ‹è¯•ç”¨ä¾‹ï¼‰

Authï¼šJWT + åŸºæœ¬ RBACï¼ˆå­¦ç”Ÿ/æ•™å¸ˆ/ç®¡ç†å‘˜ï¼‰

éƒ¨ç½²ï¼šDocker Compose å¯åšæœ¬åœ°/å°å›¢é˜Ÿæµ‹è¯•ï¼Œç”Ÿäº§ç”¨ K8s æˆ–äº‘æœåŠ¡ï¼ˆGCP/AWS/Azureï¼‰

å…³é”®å®‰å…¨/åˆè§„ä¸æ•™å­¦æ³¨æ„ç‚¹

ä»£ç æ²™ç®±ç»å¯¹å…³é”®ï¼šä¸¥æ ¼æ—¶é—´ã€å†…å­˜ã€syscall é™åˆ¶ï¼›ç½‘ç»œå‡ºç«™é»˜è®¤ç¦æ­¢ï¼ˆé™¤ééœ€è¦ï¼‰

ç”¨æˆ·ä»£ç éš”ç¦»ï¼šä¸åŒå­¦ç”Ÿä½œä¸šäº’ä¸å½±å“ï¼Œæ—¥å¿—ä¸æ–‡ä»¶ç³»ç»Ÿéš”ç¦»

LLM ä½¿ç”¨ä¿æŠ¤ï¼šè¿‡æ»¤æ•æ„Ÿä¿¡æ¯ï¼ˆå­¦ç”Ÿä¸ªäººä¿¡æ¯ï¼‰å‘é€ç»™ç¬¬ä¸‰æ–¹æ¨¡å‹ï¼›ä¿å­˜äº¤äº’è®°å½•éœ€åˆè§„ï¼ˆæ•™å¸ˆ/å­¦æ ¡æ”¿ç­–ï¼‰

åä½œå¼Šï¼šè®°å½•æäº¤å†å²ã€ç›¸ä¼¼åº¦æ£€æµ‹ï¼ˆå¯ç”¨æ–‡æœ¬ç›¸ä¼¼åº¦/embeddingï¼‰

éšç§ï¼šå‘å­¦ç”Ÿ/å®¶é•¿æ˜ç¡®è¯´æ˜ LLM ä½¿ç”¨æ¡æ¬¾ & æ•°æ®ä¿ç•™ç­–ç•¥

MVP åŠŸèƒ½åˆ†è§£ï¼ˆå¯ç›´æ¥äº¤ä»˜çš„æœ€å°é›†åˆï¼‰

ç”¨æˆ·æ³¨å†Œ/ç™»å½•ï¼ˆå­¦ç”Ÿ/æ•™å¸ˆï¼‰

æ•™å¸ˆå‘å¸ƒé¢˜ç›®ï¼ˆæè¿° + è¾“å…¥è¾“å‡ºæ ·ä¾‹ + éšè—æµ‹è¯•ç”¨ä¾‹ï¼‰

å­¦ç”Ÿä»£ç ç¼–è¾‘ + è¿è¡Œï¼ˆå®æ—¶è¾“å‡ºï¼‰

å¼¹å‡ºâ€œæ™ºèƒ½åŠ©æ•™â€æŒ‰é’®ï¼šæŠŠä»£ç ã€é”™è¯¯ã€æµ‹è¯•ç”¨ä¾‹æ‘˜è¦å‘ç»™ LLM â†’ è¿”å›å¸®åŠ©æ–‡æœ¬/ä»£ç ç‰‡æ®µ

è‡ªåŠ¨åˆ¤é¢˜ï¼ˆéšè—æµ‹è¯•ç”¨ä¾‹ï¼‰ + æ•™å¸ˆæŸ¥çœ‹åˆ†æ•°/æäº¤è¯¦æƒ…

å¯å¤ç”¨çš„ Prompt æ¨¡æ¿ï¼ˆLLM ç»™å­¦ç”Ÿä¸ªæ€§åŒ–å¸®åŠ©ï¼‰

ä¸‹é¢æ˜¯ç»™ LLM çš„æ¨¡æ¿ï¼ˆåç«¯å¡«å…¥å®é™…å­—æ®µï¼‰â€”â€”ç®€æ´ã€ç»“æ„åŒ–ï¼Œæ–¹ä¾¿æ¨¡å‹ç»™å‡ºæœ‰ç”¨å»ºè®®ã€‚

ç³»ç»Ÿæç¤ºï¼š
ä½ æ˜¯é«˜ä¸­ä¿¡æ¯è¯¾çš„æ™ºèƒ½åŠ©æ•™ã€‚ç”¨ç®€æ˜çš„ä¸­æ–‡å›ç­”ï¼Œé€‚é…é«˜ä¸­ç”Ÿæ°´å¹³ã€‚ä¸è¦ç›´æ¥ç»™å‡ºå®Œæ•´ç­”æ¡ˆï¼ˆé™¤éå­¦ç”Ÿæ˜ç¡®è¦æ±‚ï¼‰ï¼Œä¼˜å…ˆç»™æç¤ºã€é”™è¯¯å®šä½å’Œä¸‹ä¸€æ­¥å»ºè®®ã€‚æ ‡æ˜éš¾åº¦ä¸è§£é‡Šã€‚

ç”¨æˆ·ä¸Šä¸‹æ–‡ï¼š
- é¢˜ç›®æè¿°: {problem_description}
- è¯­è¨€: {language}
- å­¦ç”Ÿä»£ç :
{student_code}
- æœ€è¿‘è¿è¡Œè¾“å‡º:
{stdout}
{stderr}
- å­¦ç”Ÿç›®æ ‡: {student_goal}  # e.g., â€œæˆ‘æƒ³é€šè¿‡æ‰€æœ‰æµ‹è¯•â€ / â€œæˆ‘ä¸æ‡‚ä¸ºä»€ä¹ˆå¾ªç¯å‡ºé”™â€

è¦æ±‚ï¼š
1. æŒ‡å‡º 2-3 ä¸ªæœ€å¯èƒ½çš„é—®é¢˜ç‚¹ï¼ˆå¹¶è§£é‡Šä¸ºä»€ä¹ˆï¼‰ã€‚  
2. ç»™å‡º 1-2 ä¸ªå¯å°è¯•çš„è°ƒè¯•æ–¹æ³•ï¼ˆåŒ…å«ä¿®æ”¹å»ºè®®æˆ–ç¤ºä¾‹ç‰‡æ®µï¼‰ã€‚  
3. å¦‚æœéœ€è¦ï¼Œç»™å‡ºç®€çŸ­çš„ä¼ªä»£ç æˆ–å…³é”®è¡Œä¿®æ”¹ï¼ˆä¸è¶…è¿‡ 20 è¡Œï¼‰ã€‚  
4. æœ€åç»™å­¦ä¹ å»ºè®®ï¼ˆæ¦‚å¿µè¦ç‚¹ã€æ¨èç»ƒä¹ ï¼‰ã€‚

å›å¤ç»“æ„åŒ– JSONï¼š
{
 "hints": ["..."], 
 "fix_snippet": "ä»£ç ç‰‡æ®µï¼ˆå¯è¿è¡Œï¼‰æˆ–ç©ºå­—ç¬¦ä¸²",
 "explanation": "...ç®€çŸ­è§£é‡Š",
 "learning_tips": ["..."]
}


åç«¯å¯ä»¥æŠŠæ¨¡å‹è¾“å‡ºå†æ ¼å¼åŒ–ã€å‘ˆç°åœ¨ UI çš„â€œæ™ºèƒ½åŠ©æ•™â€å¯¹è¯çª—ä¸­ã€‚

æœ€æ ¸å¿ƒçš„ä¸¤æ®µç¤ºä¾‹ä»£ç ï¼ˆå¯é©¬ä¸Šè¿è¡Œçš„åŸå‹ï¼‰
1) åç«¯ï¼šFastAPI + ç®€æ˜“ Docker æ‰§è¡Œï¼ˆç¤ºä¾‹ï¼Œä»…åšå­¦ä¹ ç”¨ï¼Œç”Ÿäº§å¿…é¡»æ›´ä¸¥ï¼‰

æ³¨æ„ï¼šä¸‹é¢ç”¨ docker run åšç¤ºä¾‹ã€‚ç”Ÿäº§ä¸­åº”ä½¿ç”¨æ± åŒ–å®¹å™¨ã€èµ„æºæ§åˆ¶ä¸æ›´ä¸¥æ ¼çš„å®‰å…¨ç­–ç•¥ã€‚ä¸è¦åœ¨ä¸å®‰å…¨ç¯å¢ƒç›´æ¥è¿è¡Œä¸‹é¢ä»£ç ã€‚

# file: backend/main.py
from fastapi import FastAPI, HTTPException
from pydantic import BaseModel
import subprocess, uuid, os, shutil, tempfile, time

app = FastAPI()

class RunRequest(BaseModel):
    language: str
    code: str
    stdin: str = ""

@app.post("/run")
def run_code(req: RunRequest):
    # 1. åˆ›å»ºä¸´æ—¶ç›®å½•å¹¶å†™æ–‡ä»¶
    tmpdir = tempfile.mkdtemp(prefix="run_")
    try:
        if req.language == "python":
            code_file = os.path.join(tmpdir, "main.py")
            with open(code_file, "w", encoding="utf-8") as f:
                f.write(req.code)
            # 2. ç”¨ docker å¯åŠ¨éš”ç¦»æ‰§è¡Œï¼ˆæ³¨æ„ï¼šç¤ºä¾‹é™åˆ¶å¾ˆå¼±ï¼‰
            container_cmd = [
                "docker", "run", "--rm",
                "--network", "none",            # ç¦ç½‘ç»œ
                "--memory", "200m",             # é™å†…å­˜
                "--cpus", "0.5",
                "-v", f"{code_file}:/workspace/main.py:ro",
                "python:3.11-slim",
                "bash", "-c", "python /workspace/main.py"
            ]
            # è®¾ç½®è¶…æ—¶
            proc = subprocess.Popen(container_cmd, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)
            try:
                stdout, stderr = proc.communicate(input=req.stdin.encode(), timeout=5)
            except subprocess.TimeoutExpired:
                proc.kill()
                return {"stdout": "", "stderr": "TimeoutExpired", "exitcode": -1}
            return {
                "stdout": stdout.decode(errors="ignore"),
                "stderr": stderr.decode(errors="ignore"),
                "exitcode": proc.returncode
            }
        else:
            raise HTTPException(status_code=400, detail="unsupported language")
    finally:
        shutil.rmtree(tmpdir)


æé†’ï¼šä¸Šé¢åªæ˜¯æ¼”ç¤ºã€‚ç”Ÿäº§è¯·ä½¿ç”¨å®¹å™¨æ± ã€åªè¯»æŒ‚è½½ã€æ›´ä¸¥æ ¼ seccompã€ç¦ç”¨ docker çš„ host socket ç­‰ï¼›æˆ–ç›´æ¥ä½¿ç”¨ Judge0/Piston æœåŠ¡ã€‚

2) å‰ç«¯ï¼ˆReactï¼‰ç¤ºä¾‹ï¼šMonaco ç¼–è¾‘å™¨ + è°ƒç”¨ /run

è¿™ä¸ªä¾‹å­å¾ˆçŸ­ï¼Œåªå±•ç¤ºè°ƒç”¨å’Œæ˜¾ç¤ºè¾“å‡ºçš„æ ¸å¿ƒé€»è¾‘ã€‚

// file: src/components/CodeRunner.jsx
import React, { useState } from "react";
import Editor from "@monaco-editor/react";

export default function CodeRunner() {
  const [code, setCode] = useState(`print("Hello world")`);
  const [output, setOutput] = useState("");

  async function run() {
    setOutput("Running...");
    const res = await fetch("/api/run", {  // ç”Ÿäº§æ—¶åç«¯å¯èƒ½åœ¨ /api
      method: "POST",
      headers: {"Content-Type":"application/json"},
      body: JSON.stringify({language: "python", code, stdin: ""})
    });
    const data = await res.json();
    setOutput(`Exit: ${data.exitcode}\nStdout:\n${data.stdout}\nStderr:\n${data.stderr}`);
  }

  return (
    <div style={{display:"flex", height:"80vh"}}>
      <div style={{flex:1}}>
        <Editor height="100%" defaultLanguage="python" value={code} onChange={(v)=>setCode(v)} />
        <button onClick={run}>Run</button>
      </div>
      <div style={{width: "40%", padding: 10, background: "#f7f7f7"}}>
        <h3>Output</h3>
        <pre>{output}</pre>
      </div>
    </div>
  );
}

æ•™å­¦ä¸äº¤äº’è®¾è®¡ï¼ˆå­¦ç”Ÿä½“éªŒè¦ç‚¹ï¼‰

è¿è¡Œæ—¶é—´çŸ­ã€è¾“å‡ºç«‹å³ï¼ˆè¿›é˜¶å†æ”¯æŒæ–­ç‚¹/step è°ƒè¯•ï¼‰

æ™ºèƒ½åŠ©æ•™åœ¨ UI ä¾§æ ï¼šæ˜¾ç¤ºâ€œå®šä½é—®é¢˜ â†’ å°æç¤º â†’ è‹¥éœ€å®Œæ•´è§£ç­”å¯æ˜¾ç¤ºå®Œæ•´è§£æ³•ï¼ˆæ•™å¸ˆå¯æ§åˆ¶æ˜¯å¦å…è®¸ï¼‰â€

æ•™å¸ˆå¯ä»¥ä¸ºç»ƒä¹ è®¾ç½®â€œæç¤ºç­‰çº§â€ï¼š0ï¼ˆä¸ç»™æç¤ºï¼‰â†’ 1ï¼ˆä¸€ç‚¹æç¤ºï¼‰â†’ 2ï¼ˆæ›´æ˜ç¡®ï¼‰â†’ 3ï¼ˆå®Œæ•´ç¤ºä¾‹ï¼‰

æç¤ºåº”é€æ­¥æ­éœ²ï¼Œé¿å…å­¦ç”Ÿè¿‡æ—©æŠ„ç­”æ¡ˆ

æ•™å¸ˆç«¯åŠŸèƒ½ï¼ˆé«˜ ROIï¼‰

æ‰¹é‡å¯¼å…¥é¢˜åº“ï¼ˆJSONï¼‰

æŸ¥çœ‹å­¦ç”Ÿæäº¤ä¸å†å²ã€é€æ¡è¯„è¯­

å¯è®¾ç½®è‡ªåŠ¨åˆ¤åˆ† + æ‰‹åŠ¨è¦†å†™åˆ†æ•°

ç»Ÿè®¡ï¼ˆç­çº§æŒæ¡åº¦ã€å¸¸è§é”™è¯¯ï¼‰â€”â€”å¯ç”¨ embeddings åˆ†æå­¦ç”Ÿé—®ç­”/é”™è¯¯èšç±»
ğŸ¯ åŠŸèƒ½ç›®æ ‡

åŠŸèƒ½åï¼š æ™ºèƒ½é—®é¢˜æ€»ç»“ï¼ˆAI æ•™å¸ˆåŠ©æ‰‹ï¼‰
ç›®æ ‡ï¼š

å®šæœŸï¼ˆæˆ–å®æ—¶ï¼‰åˆ†ææ‰€æœ‰å­¦ç”Ÿçš„ä»£ç è¿è¡Œè®°å½•ã€é”™è¯¯æ—¥å¿—ã€ä¸æ™ºèƒ½åŠ©æ•™çš„å¯¹è¯ï¼Œè‡ªåŠ¨ç”Ÿæˆä¸€ä»½ã€Œå­¦ä¹ å›°éš¾æ€»ç»“æŠ¥å‘Šã€ï¼Œå‘Šè¯‰è€å¸ˆï¼š

å“ªäº›çŸ¥è¯†ç‚¹æœ€å®¹æ˜“å‡ºé”™ï¼›

å­¦ç”Ÿæœ€å¸¸è§çš„é”™è¯¯ç±»å‹ï¼›

å“ªäº›å­¦ç”Ÿè¿˜æ²¡æŒæ¡ï¼›

æ¨èè¯¾å ‚è®²è§£é‡ç‚¹ã€‚

ğŸ§­ æ•°æ®æµä¸æ¶æ„æ€è·¯
å­¦ç”Ÿ â†’ æäº¤ä»£ç  & ä¸åŠ©æ•™äº’åŠ¨ â†’ æ•°æ®å…¥åº“
     â†’ [å®šæ—¶ä»»åŠ¡/è§¦å‘ä»»åŠ¡] â†’ AI åˆ†ææ¨¡å—
          â†’ è°ƒç”¨ LLM åšèšåˆæ€»ç»“
               â†’ ç”ŸæˆæŠ¥å‘Š JSON / Markdown
                    â†’ æ•™å¸ˆç«¯æŸ¥çœ‹ï¼ˆdashboard æˆ– PDFï¼‰

æ•°æ®æºä¸»è¦åŒ…æ‹¬ï¼š
æ•°æ®	æ¥æº	å†…å®¹
æäº¤è®°å½•	backend DB (submissions)	ä»£ç ã€é”™è¯¯ç±»å‹ã€æµ‹è¯•ç»“æœ
åŠ©æ•™å¯¹è¯	backend DB (chat_logs)	å­¦ç”Ÿæé—®ã€æ¨¡å‹å›ç­”
é¢˜ç›®æ ‡ç­¾	problems è¡¨	æ¯é“é¢˜çš„çŸ¥è¯†ç‚¹ï¼ˆå¦‚å˜é‡ã€å¾ªç¯ã€å‡½æ•°ç­‰ï¼‰
ğŸ§© æ™ºèƒ½æ€»ç»“çš„æ ¸å¿ƒ Prompt æ¨¡æ¿

è¿™éƒ¨åˆ†æ˜¯å…³é”®ã€‚ç³»ç»Ÿå®šæœŸå–æœ€è¿‘ N æ¡è®°å½•ï¼ˆå¦‚ä¸€å‘¨å†…æ‰€æœ‰å­¦ç”Ÿæäº¤ï¼‰ï¼Œæ ¼å¼åŒ–åå‘ç»™ LLMã€‚

ç³»ç»Ÿè§’è‰²ï¼š
ä½ æ˜¯é«˜ä¸­ä¿¡æ¯è¯¾çš„æ•™å­¦åŠ©æ‰‹ï¼Œå¸®åŠ©è€å¸ˆäº†è§£å­¦ç”Ÿçš„å­¦ä¹ å›°éš¾ã€‚
è¾“å…¥æ˜¯å­¦ç”Ÿçš„ä»£ç è¿è¡Œé”™è¯¯ã€LLM åŠ©æ•™é—®ç­”è®°å½•ä»¥åŠé¢˜ç›®æ ‡ç­¾ã€‚
è¯·ç»Ÿè®¡å¹¶æ€»ç»“å‡ºç°é¢‘ç‡æœ€é«˜çš„é”™è¯¯ç±»å‹ã€çŸ¥è¯†ç‚¹ã€ä»¥åŠå»ºè®®çš„è®²è§£é‡ç‚¹ã€‚

è¾“å…¥æ ¼å¼ï¼š
[
  {
    "student_id": "S001",
    "problem_id": "P101",
    "tags": ["å˜é‡", "è¾“å…¥è¾“å‡º"],
    "error_type": "SyntaxError: missing ':' after 'if'",
    "hint_summary": "å­¦ç”Ÿä¸ç†è§£ if è¯­å¥è¯­æ³•"
  },
  ...
]

è¾“å‡ºè¦æ±‚ï¼š
ç”Ÿæˆä¸€ä¸ªç»“æ„åŒ–æŠ¥å‘Šï¼ŒJSON æ ¼å¼ï¼š
{
 "top_mistakes": [
   {"topic": "æ¡ä»¶è¯­å¥", "count": 12, "example_error": "å¿˜è®°å†™å†’å·", "suggestion": "å¤šè®² if è¯­å¥ç»“æ„"}
 ],
 "students_to_focus": ["S001", "S009", "S014"],
 "teaching_suggestions": [
   "åŠ å¼ºè¯­æ³•è§„èŒƒç»ƒä¹ ",
   "å¤šåšå˜é‡ä¸è¾“å…¥è¾“å‡ºé¢˜"
 ],
 "summary_text": "å¤§éƒ¨åˆ†å­¦ç”Ÿåœ¨æ¡ä»¶è¯­å¥å’Œå¾ªç¯ç†è§£ä¸Šæœ‰å›°éš¾ï¼Œå»ºè®®ä¸‹èŠ‚è¯¾é‡ç‚¹è®²..."
}


ä½ å¯ä»¥åœ¨åå°è‡ªåŠ¨è°ƒ OpenAI çš„ gpt-4o-mini æˆ– gpt-4-turbo æ¥ç”Ÿæˆã€‚

âš™ï¸ æŠ€æœ¯å®ç°æ–¹æ¡ˆ
ï¼ˆ1ï¼‰æ•°æ®åº“è¡¨è®¾è®¡è¡¥å……
-- å­¦ç”Ÿæäº¤
CREATE TABLE submissions (
  id SERIAL PRIMARY KEY,
  student_id VARCHAR(50),
  problem_id VARCHAR(50),
  language VARCHAR(20),
  code TEXT,
  result JSONB,
  created_at TIMESTAMP DEFAULT NOW()
);

-- åŠ©æ•™é—®ç­”è®°å½•
CREATE TABLE chat_logs (
  id SERIAL PRIMARY KEY,
  student_id VARCHAR(50),
  problem_id VARCHAR(50),
  role VARCHAR(10),  -- 'user' or 'assistant'
  message TEXT,
  created_at TIMESTAMP DEFAULT NOW()
);

-- æ•™å¸ˆæŠ¥å‘Š
CREATE TABLE ai_reports (
  id SERIAL PRIMARY KEY,
  report_date DATE,
  summary JSONB,
  created_at TIMESTAMP DEFAULT NOW()
);

ï¼ˆ2ï¼‰åç«¯ä»»åŠ¡ï¼ˆFastAPI + å®šæ—¶ä»»åŠ¡ï¼‰

ç”¨ FastAPI + APScheduler / Celery å®ç°å‘¨æœŸä»»åŠ¡ï¼Œæ¯”å¦‚æ¯å¤©æ™šä¸Šè‡ªåŠ¨ç”ŸæˆæŠ¥å‘Šã€‚

# backend/ai_reports.py
from fastapi import APIRouter
from datetime import datetime, timedelta
import openai, json
from database import get_recent_logs  # ä½ å®šä¹‰çš„æŸ¥è¯¢å‡½æ•°

router = APIRouter()

@router.post("/generate_report")
async def generate_ai_report():
    logs = get_recent_logs(days=7)  # æœ€è¿‘ä¸€å‘¨çš„æäº¤å’ŒåŠ©æ•™äº¤äº’
    prompt = f"""
    ä½ æ˜¯é«˜ä¸­ä¿¡æ¯è¯¾çš„æ•™å­¦åŠ©æ‰‹ï¼Œè¯·åˆ†æä»¥ä¸‹å­¦ç”Ÿçš„é”™è¯¯è®°å½•ï¼š
    {json.dumps(logs, ensure_ascii=False, indent=2)}
    æŒ‰ä¸Šé¢çš„è¾“å‡ºæ ¼å¼ç”ŸæˆæŠ¥å‘Šã€‚
    """
    response = openai.ChatCompletion.create(
        model="gpt-4o-mini",
        messages=[{"role":"system","content":"ä½ æ˜¯æ•™å­¦åˆ†æAI"}, {"role":"user","content":prompt}],
        temperature=0.3
    )
    report = json.loads(response["choices"][0]["message"]["content"])
    save_report_to_db(report)
    return {"status": "ok", "report": report}


æ•™å¸ˆç«¯å¯ä»¥ç‚¹å‡»ã€Œç”ŸæˆæŠ¥å‘Šã€æ‰‹åŠ¨è§¦å‘ï¼Œæˆ–è€…åå°è‡ªåŠ¨è·‘ã€‚

ï¼ˆ3ï¼‰å‰ç«¯æ•™å¸ˆç«¯å±•ç¤ºï¼ˆReact ç¤ºä¾‹ï¼‰
// TeacherDashboard.jsx
import React, { useEffect, useState } from "react";

export default function TeacherDashboard() {
  const [report, setReport] = useState(null);

  useEffect(() => {
    fetch("/api/reports/latest")
      .then(r => r.json())
      .then(setReport);
  }, []);

  if (!report) return <div>åŠ è½½ä¸­...</div>;

  return (
    <div className="p-6">
      <h2 className="text-xl font-bold mb-4">å­¦ç”Ÿé—®é¢˜æ€»ç»“æŠ¥å‘Š</h2>
      <h3>å¸¸è§é”™è¯¯</h3>
      <ul>
        {report.top_mistakes.map((m, i) => (
          <li key={i}>
            <strong>{m.topic}</strong> ({m.count} æ¬¡)ï¼š{m.example_error}  
            â†’ å»ºè®®ï¼š{m.suggestion}
          </li>
        ))}
      </ul>
      <h3 className="mt-4">éœ€å…³æ³¨å­¦ç”Ÿï¼š</h3>
      <p>{report.students_to_focus.join(", ")}</p>
      <h3 className="mt-4">æ•™å­¦å»ºè®®ï¼š</h3>
      <ul>
        {report.teaching_suggestions.map((s, i) => <li key={i}>{s}</li>)}
      </ul>
      <div className="mt-6 bg-gray-100 p-4 rounded">
        <strong>æ€»ç»“ï¼š</strong> {report.summary_text}
      </div>
    </div>
  );
}

ğŸ“Š å¯è¿›é˜¶çš„æ™ºèƒ½åˆ†æï¼ˆç¬¬äºŒé˜¶æ®µï¼‰

å½“æ•°æ®ç§¯ç´¯åï¼Œä½ å¯ä»¥å¢åŠ ï¼š

åŠŸèƒ½	æŠ€æœ¯ç‚¹
é”™è¯¯èšç±»	Embedding + K-Means èšç±»å­¦ç”Ÿé”™è¯¯ç±»å‹
çŸ¥è¯†å›¾è°±	é¢˜ç›®æ ‡ç­¾ï¼ˆå˜é‡ã€å¾ªç¯ã€å‡½æ•°ï¼‰ â†’ é”™è¯¯èšåˆåˆ°çŸ¥è¯†ç‚¹
å­¦ç”Ÿæˆé•¿æ›²çº¿	æ¯ä¸ªå­¦ç”ŸæŒ‰å‘¨æ±‡æ€»æ­£ç¡®ç‡ + åŠ©æ•™äº¤äº’æ¬¡æ•°
ä¸ªæ€§åŒ–å»ºè®®	AI ç»™æ¯ä¸ªå­¦ç”Ÿè¾“å‡ºä¸“å±å­¦ä¹ æŠ¥å‘Š
æ•™å¸ˆä»ªè¡¨æ¿	æŸ±çŠ¶å›¾/çƒ­åŠ›å›¾ï¼šç­çº§æŒæ¡åº¦ vs çŸ¥è¯†ç‚¹
ğŸ§  æ•™å­¦å±‚é¢ä»·å€¼ï¼ˆè€å¸ˆç«¯ä½“éªŒï¼‰

æœ€ç»ˆè€å¸ˆä¼šçœ‹åˆ°ï¼š

ğŸ“… å‘¨æŠ¥ (10æœˆç¬¬2å‘¨)
ğŸ§© ä¸»è¦é—®é¢˜ï¼š
 - æ¡ä»¶è¯­å¥ (12äºº)
 - å¾ªç¯é€»è¾‘ (9äºº)
 - è¾“å…¥è¾“å‡ºæ ¼å¼é”™è¯¯ (5äºº)

ğŸ‘©â€ğŸ« æ¨èè®²è§£é‡ç‚¹ï¼š
 - if/else è¯­å¥ç»“æ„ä¸ç¼©è¿›
 - for å¾ªç¯è¯­ä¹‰ä¸è¾¹ç•Œæ¡ä»¶

ğŸ“ˆ å­¦ç”Ÿåå•ï¼š
 - å­¦ä¹ è¿›æ­¥æ˜¾è‘—ï¼šS005, S008
 - éœ€å…³æ³¨ï¼šS001, S014 (é”™è¯¯ç‡>60%)

ğŸ’¬ AI æ€»ç»“ï¼š
å¤šæ•°å­¦ç”Ÿåœ¨æ§åˆ¶ç»“æ„ç†è§£ä¸Šå­˜åœ¨å›°éš¾ï¼Œå»ºè®®ç»“åˆå¯è§†åŒ–æµç¨‹å›¾è®²è§£...

âœ… æ€»ç»“ï¼šä½ ç°åœ¨æ‹¥æœ‰çš„æ•´ä½“åŠŸèƒ½çº¿
æ¨¡å—	åŠŸèƒ½
å­¦ç”Ÿç«¯	ä»£ç ç¼–è¾‘ã€è¿è¡Œã€æ™ºèƒ½åŠ©æ•™
æ•™å¸ˆç«¯	æŸ¥çœ‹æäº¤ã€ç”Ÿæˆ AI æŠ¥å‘Šã€æŒæ¡ç­çº§é—®é¢˜åˆ†å¸ƒ
åç«¯	FastAPI + Judge0/Piston æ‰§è¡Œ + LLM äº¤äº’ + AI æ±‡æ€»æŠ¥å‘Š
æ•°æ®	Submissionsã€Chat Logsã€AI Reports
å®‰å…¨	æ²™ç®± + éšç§è¿‡æ»¤ + å®¡è®¡è®°å½•